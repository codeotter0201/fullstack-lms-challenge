# ---
# 👉 [R1 規劃 2/5] 核心功能說明 (上)

### 1. 認證與權限系統

**登入方式**
- 技術實作: Email/Password 傳統認證 (Spring Security + JWT)
- UI 設計: 簡潔現代的登入介面 (自行設計,功能優先)
- 說明: 為了簡化 R1 開發複雜度,我們使用傳統帳密認證,UI 採用簡潔實用的設計風格

**用戶身分組 (回應 Q4: 三層架構)**
- R1 實作: 三層架構 (學員 + 老師 + 管理員)
  - 學員: 免費學員、付費學員
  - 老師: 審核道館作業、管理課程
  - 管理員: 管理用戶、系統設定
- 資料庫設計: users - user_roles - roles (多對多關係)
  - 採用 RBAC 系統,為未來多身分組擴充預留空間
  - R1-R3 期間一個用戶只有一個主要角色
  - 資料結構支援未來一個用戶擁有多個身分組
- 未來擴充計畫 (R3-R4 後續):
  - 類似 Discord 的多身分組系統
  - 每個用戶可擁有多個身分 (例如: 同時是付費學員 + 助教)
  - 以「身分組」為單位進行權限控管

**權限驗證**
- 前端驗證: 檢查 JWT Token 中的用戶角色,控制 UI 顯示
- 後端驗證: 每個 API 都會驗證用戶權限,防止越權訪問
- 付費內容鎖定: 免費用戶看到付費課程時顯示鎖定圖示與升級提示

### 2. 課程觀看功能

**YouTube 影片播放器**
- 嵌入方式: YouTube IFrame API
- 播放控制: 播放、暫停、進度條、音量、全螢幕
- 載入狀態: 顯示載入動畫,處理載入失敗情境

**付費課程鎖定機制**
- 免費用戶行為:
  - 看到課程列表中的付費課程標籤
  - 點擊付費課程時,影片區塊顯示鎖定遮罩
  - 顯示升級提示訊息
- 付費用戶行為:
  - 可以正常觀看所有課程內容
  - 無任何限制

### 3. 影片進度追蹤

**自動儲存機制**
- 頻率: 每 10 秒自動發送進度更新請求
- 儲存內容: 課程 ID、單元 ID、影片當前播放秒數、影片總長度、完成百分比

**斷點續播**
- 觸發時機: 用戶重新進入課程頁面時
- 行為: 自動跳轉到上次觀看的秒數,繼續播放
- 資料來源: 從後端 API 取得上次觀看記錄

**完成判定**
- 判定條件: 觀看進度達到 100% 即視為完成
- 狀態標記: 完成後在資料庫標記該單元為「已完成」,單元旁邊顯示可點擊的小圈圈
- 實作彈性: 實際閾值可設定為 95-100%,避免片尾黑畫面問題,後續可調整
